@using LogicaNegocio.Extra
@model PublicacionDTO
@{
    ViewData["Title"] = "Detalles de la Publicación";
}
<link rel="stylesheet" href="~/css/detallesPublicacion.css" />

<div class="container mt-4">
    <h2 class="text-white">Detalles de la Publicación</h2>

    <div class="bg-dark p-4 rounded mt-3">
        <h3 class="text-danger">@Model.Titulo</h3>
        <p>@Model.Descripcion</p>
        <p class="text-muted">Creada por <strong>@Model.NombreAutor</strong> el @Model.FechaCreacion.ToShortDateString()</p>

        @if (Model.Estado == Enum_EstadoPublicacion.Rechazada && !string.IsNullOrEmpty(Model.MotivoRechazo))
        {
            <hr />
            <p class="text-warning"><strong>Motivo del rechazo:</strong> @Model.MotivoRechazo</p>
        }

        <hr />
        <h5>Videos</h5>
        @if (Model.Medias.Any(m => m.Tipo == Enum_TipoMedia.Video))
        {
            <div class="media-slider">
                @foreach (var video in Model.Medias.Where(m => m.Tipo == Enum_TipoMedia.Video))
                {
                    <video class="video-preview" src="@video.Url" controls></video>
                }
            </div>
        }
        else
        {
            <p class="text-muted">No se subieron videos.</p>
        }

        <h5 class="mt-3">Imágenes</h5>
        @if (Model.Medias.Any(m => m.Tipo == Enum_TipoMedia.Imagen))
        {
            <div class="media-slider">
                @foreach (var img in Model.Medias.Where(m => m.Tipo == Enum_TipoMedia.Imagen))
                {
                    <img class="img-preview" src="@img.Url" />
                }
            </div>
        }
        else
        {
            <p class="text-muted">No se subieron imágenes.</p>
        }

        @if (Model.Estado == Enum_EstadoPublicacion.Aprobada)
        {
            <hr />
            <h5>Comentarios</h5>
            @if (Model.Comentarios != null && Model.Comentarios.Any())
            {
                <ul class="list-group">
                    @foreach (var com in Model.Comentarios)
                    {
                        <li class="list-group-item bg-dark text-white mb-2">
                            <p><strong>@com.AutorNombre</strong> <span class="text-muted">(@com.RolAutor)</span></p>
                            <p>@com.Contenido</p>
                            <small class="text-muted">@com.FechaCreacion.ToShortDateString()</small>
                        </li>
                    }
                </ul>
            }
            else
            {
                <p class="text-muted">No hay comentarios aún.</p>
            }
        }
    </div>
</div>
