@using LogicaNegocio.Extra
@model PublicacionDTO

@{
    ViewData["Title"] = "Revisión de Publicación";
}
<link rel="stylesheet" href="~/css/revisionPublicacion.css" />

<div class="container mt-4">
    <h2 class="text-white">Revisión de Publicación</h2>

    <div class="row mt-3">
        <!-- Información de la solicitud -->
        <div class="col-md-6">
            <div class="bg-dark p-3 rounded">
                <p><strong>Solicitante:</strong> @Model.NombreAutor</p>
                <p><strong>Fecha de solicitud:</strong> @Model.FechaCreacion.ToShortDateString()</p>

                <hr />
                <h4 class="text-danger">@Model.Titulo</h4>
                <p>@Model.Descripcion</p>

                <hr />
                <h5>Videos</h5>
                @if (Model.Medias.Any(m => m.Tipo == Enum_TipoMedia.Video))
                {
                    <div class="media-scroll">
                        @foreach (var video in Model.Medias.Where(m => m.Tipo == Enum_TipoMedia.Video))
                        {
                            <video src="@video.Url" class="media-video" controls></video>
                        }
                    </div>
                }
                else
                {
                    <p class="text-muted">No se cargaron videos.</p>
                }

                <h5 class="mt-3">Imágenes</h5>
                @if (Model.Medias.Any(m => m.Tipo == Enum_TipoMedia.Imagen))
                {
                    <div class="media-scroll">
                        @foreach (var img in Model.Medias.Where(m => m.Tipo == Enum_TipoMedia.Imagen))
                        {
                            <img src="@img.Url" class="media-img" />
                        }
                    </div>
                }
                else
                {
                    <p class="text-muted">No se cargaron imágenes.</p>
                }
            </div>
        </div>

        <!-- Gestión del admin -->
        <div class="col-md-6">
            <div class="bg-dark p-3 rounded">
                <h4 class="mb-3">Acciones del administrador</h4>

                <div class="mb-3">
                    <button id="btn-aceptar" class="btn btn-success me-2">Aceptar publicación</button>
                    <button id="btn-rechazar" class="btn btn-danger">Rechazar publicación</button>
                </div>

                <div id="motivo-rechazo-container" class="mt-3 d-none">
                    <label for="motivoRechazo">Motivo del rechazo:</label>
                    <textarea id="motivoRechazo" class="form-control" rows="4"></textarea>
                </div>

                <form method="post" asp-action="ConfirmarRevision">
                    <input type="hidden" name="PublicacionId" value="@Model.Id" />
                    <input type="hidden" id="accion" name="Accion" />
                    <input type="hidden" id="motivoOculto" name="MotivoRechazo" />
                    <button type="submit" id="btn-confirmar" class="btn btn-primary mt-4 d-none">Confirmar acción</button>
                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/revisionPublicacion.js"></script>
}
