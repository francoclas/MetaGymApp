@using LogicaNegocio.Extra
@model GestionCitasModelo

@{
    ViewBag.Title = "Gestión de Citas";
}

<link rel="stylesheet" href="~/css/profesional/gestionCitas..css" />

<div class="container mt-4 bg-dark border rounded py-4 text-white">
    <a class="btn btn-outline-light mb-3" asp-controller="Agenda" asp-action="MisAgendas">
        Gestionar mi tiempo de trabajo
    </a>

    <ul class="nav nav-tabs mb-4" id="tabsCitas">
        <li class="nav-item">
            <a class="nav-link active" data-tab="espera">Solicitudes</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-tab="proximas">Próximas</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-tab="finalizadas">Finalizadas</a>
        </li>
    </ul>

    <div class="mb-3">
        <input type="text" id="filtroCitas" class="form-control" placeholder="Buscar citas por nombre, especialidad o descripción...">
    </div>

    <div class="mb-4">
        <button class="btn btn-outline-light btn-sm me-2" onclick="ordenarCitas('asc')">Más viejas</button>
        <button class="btn btn-outline-light btn-sm" onclick="ordenarCitas('desc')">Más nuevas</button>
    </div>

    <!-- Sección Solicitudes -->
    <div class="tab-content" id="tab-espera">
        @foreach (var cita in Model.CitasEnEspera)
        {
            <div class="card mb-3 cita-card" data-fecha="@cita.FechaAsistencia.ToString("yyyy-MM-ddTHH:mm")">
                <div class="card-body d-flex justify-content-between">
                    <div>
                        <h5 class="card-title">@cita.Cliente.NombreCompleto</h5>
                        <p class="card-text">Especialidad: @cita.Especialidad.NombreEspecialidad</p>
                        <p class="card-text">@cita.Descripcion</p>
                        <p class="card-text"><small class="text-muted">Fecha: @cita.FechaAsistencia.ToString("dd/MM/yyyy HH:mm")</small></p>
                    </div>
                    <div>
                        <a href="@Url.Action("RevisarCita", "Profesional", new { id = cita.CitaId })" class="btn btn-primary">Revisar</a>
                    </div>
                </div>
            </div>
        }
    </div>

    <!-- Sección Próximas -->
    <div class="tab-content d-none" id="tab-proximas">
        @foreach (var cita in Model.CitasProximasDeProfesional)
        {
            <div class="card mb-3 cita-card" data-fecha="@cita.FechaAsistencia.ToString("yyyy-MM-ddTHH:mm")">
                <div class="card-body d-flex justify-content-between">
                    <div>
                        <h5 class="card-title">@cita.Cliente.NombreCompleto</h5>
                        <p class="card-text">Especialidad: @cita.Especialidad.NombreEspecialidad</p>
                        <p class="card-text">@cita.Descripcion</p>
                        <p class="card-text"><small class="text-muted">Fecha: @cita.FechaAsistencia.ToString("dd/MM/yyyy HH:mm")</small></p>
                    </div>
                    <div>
                        <span class="badge bg-success">Confirmada</span>
                    </div>
                </div>
            </div>
        }
    </div>

    <!-- Sección Finalizadas -->
    <div class="tab-content d-none" id="tab-finalizadas">
        @foreach (var cita in Model.CitasAtendidasProfesional)
        {
            <div class="card mb-3 cita-card" data-fecha="@cita.FechaAsistencia.ToString("yyyy-MM-ddTHH:mm")">
                <div class="card-body">
                    <h5 class="card-title">@cita.Cliente.NombreCompleto</h5>
                    <p class="card-text">Especialidad: @cita.Especialidad.NombreEspecialidad</p>
                    <p class="card-text">@cita.Descripcion</p>
                    <p class="card-text"><small class="text-muted">Fecha: @cita.FechaAsistencia.ToString("dd/MM/yyyy HH:mm")</small></p>
                    <p class="card-text"><strong>Conclusión:</strong> @cita.Conclusion</p>
                </div>
            </div>
        }
    </div>
</div>

<script src="~/js/profesional/gestionCitas.js"></script>
